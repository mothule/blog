<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="ja-JP"><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="https://blog.mothule.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://blog.mothule.com/" rel="alternate" type="text/html" hreflang="ja-JP" /><updated>2020-08-17T05:07:20+09:00</updated><id>https://blog.mothule.com/feed.xml</id><title type="html">もちゅろぐ</title><subtitle>iOSやSwift,RubyやRailsなどiPhoneアプリ開発とサーバーサイド開発を中心に綴っている技術ブログ</subtitle><entry><title type="html">SSH公開鍵認証で必要なssh-keygenの使い方を理解する</title><link href="https://blog.mothule.com/tools/ssh/tools-ssh-keygen-basic" rel="alternate" type="text/html" title="SSH公開鍵認証で必要なssh-keygenの使い方を理解する" /><published>2020-08-14T00:00:00+09:00</published><updated>2020-08-17T05:06:08+09:00</updated><id>https://blog.mothule.com/tools/ssh/tools-ssh-keygen-basic</id><content type="html" xml:base="https://blog.mothule.com/tools/ssh/tools-ssh-keygen-basic">&lt;p&gt;ネット記事に書いてる通りに従ってSSH用公開鍵を作成してばかりで、ssh-keygen自体の理解が進んでいない人に向けて、ssh-keygenの公開鍵認証周りに絞って説明します。&lt;/p&gt;

&lt;h2 id=&quot;ssh-keygenとは&quot;&gt;ssh-keygenとは？&lt;/h2&gt;

&lt;p&gt;SSHの認証キーの生成と管理と変更を行うコマンドです。
SSHを公開鍵認証方式で認証したい場合にそのキーペアを生成できます。&lt;/p&gt;

&lt;h2 id=&quot;公開鍵の作成&quot;&gt;公開鍵の作成&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;公開鍵の作成は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh-keygen&lt;/code&gt;コマンドのみで作成できます。&lt;/strong&gt;&lt;br /&gt;
パラメータ用オプションが指定されていないと対話形式でパラメータを決めていきます。&lt;br /&gt;
この場合、最低限のパラメータしかイジることができません。&lt;/p&gt;

&lt;p&gt;コメントやファイル形式、暗号タイプやビット長などはデフォルト値となります。&lt;/p&gt;

&lt;p&gt;下記は指定なしで実行して作成されるまでの流れです。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen
Generating public/private rsa key pair.
Enter file &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;which to save the key &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/Users/mothule/.ssh/id_rsa&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: hoge_rsa
Enter passphrase &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;no passphrase&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
Enter same passphrase again:
Your identification has been saved &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;hoge_rsa.
Your public key has been saved &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;hoge_rsa.pub.
The key fingerprint is:
SHA256:usyuy2k2WRbKlAmx4qJSVjG3m3EkhJvKSOvmvbwRb5Y mothule@mothule.local
The key&lt;span class=&quot;se&quot;&gt;\'&lt;/span&gt;s randomart image is:
+---[RSA 3072]----+
|  ..oo+ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;        |
|  ...+ +         |
|. ...&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;o &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;        |
|.o .&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; .&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;         |
|o++&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; .o.S        |
|++o &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; +.         |
|+  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; E.          |
|.oo.O+ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;         |
|o. &lt;span class=&quot;nv&quot;&gt;BB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;          |
+----[SHA256]-----+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;この場合だと、鍵は次の情報で作成されます。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ファイル名&lt;/td&gt;
      &lt;td&gt;hoge_rsa and hoge_rsa.pub&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;パスフレーズ&lt;/td&gt;
      &lt;td&gt;asdf&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;暗号タイプ&lt;/td&gt;
      &lt;td&gt;RSA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ビット長&lt;/td&gt;
      &lt;td&gt;3072&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ファイル形式&lt;/td&gt;
      &lt;td&gt;RFC4716&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;コメント&lt;/td&gt;
      &lt;td&gt;ホスト情報&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;オプションを渡して公開鍵を作成する&quot;&gt;オプションを渡して公開鍵を作成する&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh-keygen&lt;/code&gt;コマンドにオプションを一緒に渡すことで対話形式をなくしたり、デフォルト値を変えたりできます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; 3072 &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; コメント &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/hoge_rsa &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; RFC4716 &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; asdf &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;公開鍵のフィンガープリントを表示&quot;&gt;公開鍵のフィンガープリントを表示&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-l&lt;/code&gt;オプションを使うことで公開鍵のフィンガープリントを表示します。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt;オプションをつけるとアスキーアートも表示されます。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;でキーを指定できます。無指定だと対話形式でファイル名を訪ねてきます。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-E&lt;/code&gt;オプションで表示するフィンガープリントのハッシュ関数を変更できます。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;md5&lt;/code&gt;と&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sha256&lt;/code&gt;が使えます。デフォルトはsha256です。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt; sha256 &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/github_id_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;パスフレーズの変更&quot;&gt;パスフレーズの変更&lt;/h2&gt;

&lt;p&gt;既存キーのパスフレーズを変更する場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-p&lt;/code&gt;と&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-N&lt;/code&gt;、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-P&lt;/code&gt;を使います。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;で対象キーを指定しますが、未指定時は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;id_rsa&lt;/code&gt;になります。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-p&lt;/code&gt;オプションでパスフレーズの変更を要求します。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-N&lt;/code&gt;で新しいパスフレーズを渡し、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-P&lt;/code&gt;で今のパスフレーズを渡します。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/hoge_rsa &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; qwer &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; asdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;今のパスフレーズが間違っていたらエラーになります。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Failed to load key hoge_rsa: incorrect passphrase supplied to decrypt private key&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;パスワードとパスフレーズの違い&quot;&gt;パスワードとパスフレーズの違い&lt;/h3&gt;
&lt;p&gt;パスフレーズはパスワードに似てますが、一連の単語、句読点、数字、空白、文字列を含むフレーズで構成できます。&lt;/p&gt;

&lt;p&gt;適切なパスフレーズ長さは10~30文字ぐらいです。ここの詳細は省きます。&lt;br /&gt;
気になる方は別記事でセキュリティ関連の記事を参考にしてください。&lt;/p&gt;

&lt;p&gt;パスフレーズは忘れないようにしてください。&lt;br /&gt;
消失しても復元する方法はなく、新しく鍵を作る必要があります。&lt;/p&gt;

&lt;h2 id=&quot;コメントの変更&quot;&gt;コメントの変更&lt;/h2&gt;

&lt;p&gt;既存キーのコメントを変更する場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-c&lt;/code&gt;と&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-C&lt;/code&gt;を使います。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;で対象キーを指定しますが、未指定時は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;id_rsa&lt;/code&gt;になります。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-P&lt;/code&gt;でパスフレーズ事前入力ができます。未指定でパスフレーズがあると対話形式で入力になります。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-c&lt;/code&gt;オプションでコメント変更を要求します。
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-C&lt;/code&gt;で新しいコメントを渡します。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; 新しいコメント &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/hoge_rsa &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; asdf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;known_hostsをハッシュ化&quot;&gt;known_hostsをハッシュ化&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;known_hosts&lt;/code&gt;のホスト部をハッシュ化します。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-H&lt;/code&gt;オプションを渡すことでハッシュ化されます。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;オプションでは、対象となる&lt;strong&gt;known_hosts&lt;/strong&gt;の指定ができます。&lt;br /&gt;
他のオプションでは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;はキーパスが多いので、ここはキーパスではないことに注意してください。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/known_hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;変更前のファイルは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.old&lt;/code&gt;サフィックスがついて別名保存されます。&lt;/p&gt;

&lt;h3 id=&quot;known_hostsをハッシュ化する目的&quot;&gt;known_hostsをハッシュ化する目的&lt;/h3&gt;

&lt;p&gt;セキュリティの向上です。&lt;br /&gt;
ホスト情報を分からなくすることで紐付けされにくくさせます。&lt;/p&gt;

&lt;h2 id=&quot;known_hostsから検索&quot;&gt;known_hostsから検索&lt;/h2&gt;
&lt;p&gt;ハッシュ化されたknown_hostsだと、調べたいホストがknown_hostsに登録済みか調べられません。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-F&lt;/code&gt;オプションでknown_hostsからホスト名やホスト名:ポートに一致する行を検索します。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; github &lt;span class=&quot;nt&quot;&gt;-lv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/known_hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-l&lt;/code&gt;オプションで出力をフィンガープリントに変更します。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-lv&lt;/code&gt;オプションだとアスキーアートも表示されます。&lt;/p&gt;

&lt;h2 id=&quot;known_hostsから削除&quot;&gt;known_hostsから削除&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-R&lt;/code&gt;オプションを指定することでknown_hostsからキーを削除します。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;オプションでは、対象となるknown_hostsの指定ができます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; github &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/known_hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;テキスト形式であれば直接エディタ開いて削除できますが、ハッシュ形式だとどれか分からないため、こちらを使うことになります。&lt;/p&gt;

&lt;h2 id=&quot;openssh形式の秘密鍵に紐づく公開鍵を標準出力に表示&quot;&gt;OpenSSH形式の秘密鍵に紐づく公開鍵を標準出力に表示&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-y&lt;/code&gt;オプションで秘密鍵に紐づく公開鍵を表示します。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;オプションでキー指定ができます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/github_id_rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;鍵のインポートとエクスポート&quot;&gt;鍵のインポートとエクスポート&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-i&lt;/code&gt;と&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-e&lt;/code&gt;オプションで鍵のインポートとエクスポートができます。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-f&lt;/code&gt;でファイル指定をして、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-m&lt;/code&gt;でファイル形式の指定ができます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/github_id_rsa &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; RFC4716
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh-keygen &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ~/.ssh/github_id_rsa &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; RFC4716
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ssh-keygenのオプションについて&quot;&gt;ssh-keygenのオプションについて&lt;/h2&gt;

&lt;p&gt;ssh-keygenでは、一部パラメータ用オプションを使い回す傾向があります。&lt;br /&gt;
ここでは使いまわしされてるパラメータ用オプションについてまとめます。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;オプション名&lt;/th&gt;
      &lt;th&gt;用途&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;-f&lt;/td&gt;
      &lt;td&gt;ファイルパスの指定&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-P&lt;/td&gt;
      &lt;td&gt;パスフレーズの指定&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-m&lt;/td&gt;
      &lt;td&gt;ファイル形式の指定&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-q&lt;/td&gt;
      &lt;td&gt;サイレントモードの指定&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-v&lt;/td&gt;
      &lt;td&gt;詳細モードの指定&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;ssh-keygenのオプションのデフォルト値について&quot;&gt;ssh-keygenのオプションのデフォルト値について&lt;/h2&gt;

&lt;p&gt;ssh-keygenでは、オプション未指定だとデフォルト値を使ったり、対話形式で入力をしたりします。&lt;/p&gt;

&lt;p&gt;ここではオプションのデフォルト値についてまとめます。&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;オプション名&lt;/td&gt;
      &lt;td&gt;デフォルト値&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-t&lt;/td&gt;
      &lt;td&gt;RSA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-f&lt;/td&gt;
      &lt;td&gt;id_rsaやknown_hosts&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-C&lt;/td&gt;
      &lt;td&gt;user@host形式&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;-m&lt;/td&gt;
      &lt;td&gt;RFC4716&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;一部パラメータ系オプションの挙動について&quot;&gt;一部パラメータ系オプションの挙動について&lt;/h2&gt;

&lt;p&gt;一部パラメータ系オプションは値に制限があったり、複数指定すると挙動が変わったりします。&lt;br /&gt;
ここではそれらについてまとめます。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-m&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;RFC4716(default)&lt;/li&gt;
      &lt;li&gt;PKCS8&lt;/li&gt;
      &lt;li&gt;PEM&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-t&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;rsa(default)&lt;/li&gt;
      &lt;li&gt;dsa&lt;/li&gt;
      &lt;li&gt;ecdsa&lt;/li&gt;
      &lt;li&gt;ed25519&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-E&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;md5&lt;/li&gt;
      &lt;li&gt;sha256(default)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;複数オプションを指定すると詳細度が最大で3上がります&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-b&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;キータイプが&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RSA&lt;/code&gt;の場合は1024以上、デフォルト3072ビット&lt;/li&gt;
      &lt;li&gt;ECDSAキーの場合は256, 384, 521ビット&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="tools" /><category term="ssh" /><category term="ssh-keygen" /><summary type="html">ネット記事に書いてる通りに従ってSSH用公開鍵を作成してばかりで、ssh-keygen自体の理解が進んでいない人に向けて、ssh-keygenの公開鍵認証周りに絞って説明します。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-08-14-tools-ssh-keygen-basic/eyecatch.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-08-14-tools-ssh-keygen-basic/eyecatch.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">iOSでMVVMする前に基本を整理する</title><link href="https://blog.mothule.com/ios/swift/ios-swift-mvvm" rel="alternate" type="text/html" title="iOSでMVVMする前に基本を整理する" /><published>2020-08-08T00:00:00+09:00</published><updated>2020-08-09T19:24:57+09:00</updated><id>https://blog.mothule.com/ios/swift/ios-swift-mvvm</id><content type="html" xml:base="https://blog.mothule.com/ios/swift/ios-swift-mvvm">&lt;p&gt;MVVMを知らなかったり曖昧知識で採用すると、MVCとは異なる部分で問題がおきるだけです。&lt;/p&gt;

&lt;h2 id=&quot;mvvmとは&quot;&gt;MVVMとは？&lt;/h2&gt;
&lt;p&gt;アーキテクチャパターンの一つ。
MVCの派生パターンでModel-View-ViewModel
プレゼンテーションとドメインを分離することで保守性と生産性を貢献する。&lt;/p&gt;

&lt;h3 id=&quot;model&quot;&gt;Model&lt;/h3&gt;
&lt;p&gt;アプリのドメイン（問題領域）を担当する。
ここで、このアプリが解決するドメイン(問題領域)のデータと手続き処理（ビジネスロジック）を表現する。&lt;br /&gt;
その他にも永続化ロジック、通信ロジックも含める。&lt;/p&gt;

&lt;h4 id=&quot;表示寄りデータの扱い&quot;&gt;表示寄りデータの扱い&lt;/h4&gt;
&lt;p&gt;アプリが背景色や文字色や余白のサイズなど表示カスタマイズ機能をもつ場合は、&lt;br /&gt;
それら表示に関する情報を保持するのはModelになる。&lt;br /&gt;
もちろんModelの情報はViewModelを経由してバインドされる。&lt;/p&gt;

&lt;h4 id=&quot;注意点&quot;&gt;注意点&lt;/h4&gt;
&lt;p&gt;一般的にドメインを担当すると決めつけると混乱が生じる。
例えばサーバの存在するクライアント・サーバモデルだとドメイン(問題領域)はサーバ側にあたるため、
クライアント側はアプリケーションとしてみたときにドメインではなくプレゼンテーションに該当する。&lt;/p&gt;

&lt;p&gt;ModelはViewとViewModelの役割以外の部分を担うのが妥当。&lt;/p&gt;

&lt;h3 id=&quot;view&quot;&gt;View&lt;/h3&gt;
&lt;p&gt;UIへの入出力を担当。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;アプリが扱うデータをユーザーに向けて表示&lt;/li&gt;
  &lt;li&gt;ユーザーからの入力を受け取る&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;MVVMにおけるViewはViewModelが持つデータを&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;データバインディング&lt;/code&gt;機構を通じて自身の担当領域を全うする。
Viewは複雑なロジックと状態を持たないのがMVVMのViewの特徴。&lt;/p&gt;

&lt;h4 id=&quot;データバインディング&quot;&gt;データバインディング&lt;/h4&gt;
&lt;p&gt;RxSwiftやReactiveSwiftやCombineなどを使って、予めデータとイベントと振る舞いの関係性を宣言しておくことで、&lt;br /&gt;
実際のイベント発生時には宣言した処理フローに従って振る舞いが行われる。&lt;/p&gt;

&lt;h3 id=&quot;viewmodel&quot;&gt;ViewModel&lt;/h3&gt;
&lt;p&gt;Viewが状態やロジックを待たない分ここで解決する。
Viewの見た目に影響する状態の保持、Viewから受け取った入力を適切な形に変換しModelに伝達する役目。
つまりViewとModel間の情報伝達とView用状態保持の役割を持つ。&lt;/p&gt;

&lt;h3 id=&quot;viewmodelとmodel間のバインディング&quot;&gt;ViewModelとModel間のバインディング&lt;/h3&gt;
&lt;p&gt;MVVMではView-ViewModel間はデータバインディング機構を使うことでメッセージフローを実現している。&lt;br /&gt;
では、ViewModel-Model間も同様にデータバインディングを行ってはいけないのか？というと、それは別に構わないと思っている。&lt;br /&gt;
MVVMはアーキテクチャパターンであり、そこから肉付けするのは自由だから。
メッセージフローを統一する観点においてデータバインディングやオブザーバーパターンによるメッセージフローの仕組み化を行うことは問題ないと見れる。&lt;/p&gt;

&lt;h2 id=&quot;iosでmvvmを実現するには&quot;&gt;iOSでMVVMを実現するには&lt;/h2&gt;
&lt;p&gt;MVVMは特性上&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;データバインディング&lt;/code&gt;が重要な機能となる。&lt;br /&gt;
iOSではViewとViewModel間の情報伝達を手動で同期が必要となるため、そのままでは実現コストが高くMVVMメリットへのコスパが悪い。
そのためiOSでMVVMアーキテクチャを実現するためには、データバインディング機構を何らかの方法で取り込む必要があります。&lt;/p&gt;

&lt;h3 id=&quot;データバインディング機構を提供するライブラリ&quot;&gt;データバインディング機構を提供するライブラリ&lt;/h3&gt;
&lt;p&gt;一般的に認知度の高いデータバインディング機構を提供してるライブラリ下記になります。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;RxSwift&lt;/li&gt;
  &lt;li&gt;ReactiveSwift&lt;/li&gt;
  &lt;li&gt;Combine&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;この中でCombineはiOS13からApple公式frameworkとして提供されています。&lt;br /&gt;
近い将来公式のCombineがデファクトスタンダードとなるかもしれませんが、登場して間もないためまだまだ他のライブラリの利用率が高いです。&lt;/p&gt;

&lt;h2 id=&quot;iosでmvvm採用するメリットとデメリット&quot;&gt;iOSでMVVM採用するメリットとデメリット&lt;/h2&gt;

&lt;p&gt;ここまでで得た情報からiOSでMVVMを採用することで得られるメリットとデメリットについて並べました。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Viewロジックのテスタビリティが向上&lt;/li&gt;
  &lt;li&gt;Viewロジックとドメインロジックを分離できる&lt;/li&gt;
  &lt;li&gt;データバインディング機構を提供するライブラリのメンテナンスが必要&lt;/li&gt;
  &lt;li&gt;データバインディング機構を提供するライブラリの理解が必要&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;fat-viewmodelになるリスク&quot;&gt;Fat ViewModelになるリスク&lt;/h3&gt;
&lt;p&gt;ドメイン(アプリの問題領域)を理解できていないと、&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;「ModelではないのでViewModel」&lt;/li&gt;
  &lt;li&gt;「この画面で扱うデータはドメインではなく画面依存だからViewModel」&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;など、データやロジックがドメインなのか判断できないことが起因してViewModelへと責務が委任されていきます。&lt;/p&gt;</content><author><name></name></author><category term="notebook" /><category term="program-design" /><category term="ios" /><summary type="html">MVVMを知らなかったり曖昧知識で採用すると、MVCとは異なる部分で問題がおきるだけです。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-08-08-ios-swift-mvvm/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-08-08-ios-swift-mvvm/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">SwiftのCollectionとRangeを組み合わせて使いこなし術</title><link href="https://blog.mothule.com/ios/swift/ios-swift-collection-range-tips" rel="alternate" type="text/html" title="SwiftのCollectionとRangeを組み合わせて使いこなし術" /><published>2020-08-07T00:00:00+09:00</published><updated>2020-08-07T19:34:01+09:00</updated><id>https://blog.mothule.com/ios/swift/ios-swift-collection-range-tips</id><content type="html" xml:base="https://blog.mothule.com/ios/swift/ios-swift-collection-range-tips">&lt;p&gt;SwiftのCollectionはSetやArray、Dictionaryの土台となる重要なポジションです。&lt;br /&gt;
今回は&lt;a href=&quot;https://developer.apple.com/documentation/swift/swift_standard_library/collections/supporting_types&quot;&gt;Supporting Types - Apple Developer Documentation&lt;/a&gt;にあるサポート機能について使えそうなものがないかを調べてまとめました。&lt;/p&gt;

&lt;h2 id=&quot;collectionとrangeの組み合わせ&quot;&gt;CollectionとRangeの組み合わせ&lt;/h2&gt;

&lt;p&gt;Collectionには範囲取得する機能があります。&lt;br /&gt;
範囲を表す型は、Rangeを使います。&lt;br /&gt;
例えば、下のコードを見かけた人は多いと思います。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;partial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [2, 3]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;実はこれ以外の範囲指定方法がCollectionには用意されています。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;PartialRangeUpTo: 上限のみ(上限未満)&lt;/li&gt;
  &lt;li&gt;PartialRangeThrough: 上限のみ(上限以下)&lt;/li&gt;
  &lt;li&gt;PartialRangeFrom: 下限のみ&lt;/li&gt;
  &lt;li&gt;UnboundedRange_: 上限下限なし&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;partialrangeupto-上限のみ上限未満&quot;&gt;PartialRangeUpTo: 上限のみ(上限未満)&lt;/h3&gt;

&lt;p&gt;上限値のみが指定された範囲型です。&lt;br /&gt;
下限は無制限となります。&lt;br /&gt;
そのため&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;contains&lt;/code&gt;メソッドで範囲内判定を確認するとマイナスでも&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;true&lt;/code&gt;を返します。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;upToFive&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;..&amp;lt;&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;upToFive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// PartialRangeUpTo&amp;lt;Double&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upToFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upToFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// false&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upToFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// false&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upToFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これをCollectionの範囲指定として使えます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;numbers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [4, 2, 3]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ちなみにパターンマッチング演算子(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~=&lt;/code&gt;)が用意されているので下記2つは同じ意味です。&lt;/p&gt;
&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;partialrangethrough-上限のみ上限以下&quot;&gt;PartialRangeThrough: 上限のみ(上限以下)&lt;/h3&gt;

&lt;p&gt;PartialRangeUpToと同じですが、こちらは上限値も範囲に含めます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;throughFive&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;throughFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;throughFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;throughFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// false&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;throughFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これをCollectionの範囲指定として使えます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;numbers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [4, 2, 3, 4]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;partialrangefrom-下限のみ&quot;&gt;PartialRangeFrom: 下限のみ&lt;/h3&gt;

&lt;p&gt;下限値のみが指定された範囲型です。&lt;br /&gt;
上限は無制限となります。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;contains&lt;/code&gt;メソッドで確認すると下記のようになります。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;atLeastFive&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atLeastFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// false&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atLeastFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atLeastFive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;contains&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これをCollectionの範囲指定として使えます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;numbers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [4, 5]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;unboundedrange_-上限下限なし&quot;&gt;UnboundedRange_: 上限下限なし&lt;/h3&gt;

&lt;p&gt;これはレアケースな気がしますが、上限も下限も無制限の指定方法があります。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;numbers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// [4, 2, 3, 4, 5]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;collectionrangeまとめ&quot;&gt;Collection+Rangeまとめ&lt;/h2&gt;

&lt;p&gt;出てきた書き方を下記にまとめます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;numbers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numbers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;999&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forEach&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Collectionの範囲取得で 0..&amp;lt;3 のような書き方をショートハンドのように省略できるようになります。&lt;br /&gt;
使い所は広くはありませんが、知っておくとライブラリコードで突然出てきても落ち着いて読み進めることができます。&lt;/p&gt;</content><author><name></name></author><category term="ios" /><category term="swift" /><summary type="html">SwiftのCollectionはSetやArray、Dictionaryの土台となる重要なポジションです。 今回はSupporting Types - Apple Developer Documentationにあるサポート機能について使えそうなものがないかを調べてまとめました。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-08-07-ios-swift-collection-range-tips/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-08-07-ios-swift-collection-range-tips/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Swiftの高階関数で遅延評価(lazy)を使い処理を効率化する</title><link href="https://blog.mothule.com/ios/swift/ios-swift-lazy-sequence-and-collection" rel="alternate" type="text/html" title="Swiftの高階関数で遅延評価(lazy)を使い処理を効率化する" /><published>2020-08-07T00:00:00+09:00</published><updated>2020-08-07T03:55:23+09:00</updated><id>https://blog.mothule.com/ios/swift/ios-swift-lazy-sequence-and-collection</id><content type="html" xml:base="https://blog.mothule.com/ios/swift/ios-swift-lazy-sequence-and-collection">&lt;p&gt;例えばlazyを使うと10万件のフルアクセス処理が1件で済みます。&lt;/p&gt;

&lt;h2 id=&quot;swiftの高階関数はその場でクロージャを評価する&quot;&gt;Swiftの高階関数はその場でクロージャを評価する&lt;/h2&gt;
&lt;p&gt;SwiftのCollectionなどで使える高階関数(filter, map, reduceなど)は、&lt;br /&gt;
関数が呼ばれたら、その場でクロージャが評価されます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;#function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Will call count&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;例えば上記コードを実行すると、コンソールには下記が出力されます。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;toString(from:)
Will call count
1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ケースによっては無駄な処理が生まれる&quot;&gt;ケースによっては無駄な処理が生まれる&lt;/h2&gt;

&lt;p&gt;例えば10万件に対しあるfilter処理した結果に対し&lt;strong&gt;isEmpty&lt;/strong&gt;を呼びたいケースはコードだとこうなります。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これを高階関数を使わず書くとこうなります。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isEmpty&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ①&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;isEmptyは1回でも条件満たせばいいので、それ以降のループ処理を走らせる必要がありません。&lt;br /&gt;
①の部分でisEmpty = falseの後にbreakでループを抜けるべきです。&lt;/p&gt;

&lt;h3 id=&quot;高負荷だと無駄が顕著に現れる&quot;&gt;高負荷だと無駄が顕著に現れる&lt;/h3&gt;

&lt;p&gt;例えば高階関数のクロージャが少し重かったとします。(0.001秒かかる)&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;forTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;この場合、最終的な結果を得るには、少なくとも100秒(0.001秒 × 10万件)かかります。&lt;/p&gt;

&lt;h2 id=&quot;lazy遅延評価を使う&quot;&gt;lazy(遅延評価)を使う&lt;/h2&gt;
&lt;p&gt;SwiftのSequenceやCollectionにはlazy機能があります。&lt;br /&gt;
これは実際の値が必要になるまで高階関数内クロージャを実行しません。&lt;br /&gt;
実際の値とは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;isEmpty&lt;/code&gt;や&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt;、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;first&lt;/code&gt;などです。&lt;/p&gt;

&lt;h3 id=&quot;遅延を確認する&quot;&gt;遅延を確認する&lt;/h3&gt;

&lt;p&gt;lazyを使うには、高階関数を呼ぶ前に&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lazy&lt;/code&gt;メソッドを呼びます。&lt;br /&gt;
冒頭に説明したコードを使ってlazy化します。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;#function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;lazy&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Will call count&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これを実行するとコンソールには下記が出力されます。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Will call count
toString(from:)
1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;高階関数内で呼ばれている&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;toString(from:)&lt;/code&gt;が&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Will call count&lt;/code&gt;より後に来ています。&lt;/p&gt;

&lt;h3 id=&quot;効率化を確認する&quot;&gt;効率化を確認する&lt;/h3&gt;

&lt;p&gt;Swiftのlazyにはもう一つ特徴があります。&lt;br /&gt;
それは実際の値を必要としてるメソッドによって、高階関数のクロージャを中断することです。&lt;br /&gt;
例えば先程使った100秒かかるコードをlazy化してみます。&lt;/p&gt;

&lt;div class=&quot;language-swift highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;stride&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;lazy&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;in filter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;forTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これを実行するとコンソールは下記を出力します。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;in filter
false
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;in filter&lt;/code&gt;が1回しか呼ばれていないです。
これは1回目のループで&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;true&lt;/code&gt;になったことで&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;isEmpty&lt;/code&gt;の判断ができるようになったので処理を中断してます。&lt;/p&gt;

&lt;p&gt;ちなみに&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;isEmpty&lt;/code&gt;を&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt;にすると、lazyしてないコード同様に全てのループを実行します。&lt;br /&gt;
これは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;count&lt;/code&gt;の結果を判断するには全部の処理を通さないと結果が分からないためです。&lt;/p&gt;

&lt;p&gt;つまり&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lazy&lt;/code&gt;を使うことで途中で結果が得られたら中断し得られない場合は継続します。&lt;/p&gt;

&lt;h2 id=&quot;全部lazyというわけではない&quot;&gt;全部lazyというわけではない&lt;/h2&gt;
&lt;p&gt;とりあえず全部lazyにしとけば良いというものではありません。&lt;br /&gt;
lazyにすることで通常と比べ遅延用の仕組みが必要となるため内部処理が複雑となるため速度やメモリ負荷がその分かかります。&lt;/p&gt;

&lt;p&gt;またlazyは評価を遅らせます。遅延評価のデメリットが発生することを知る必要があります。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;LazyCollectionやLazySequenceには用意されてない高階関数がある&lt;/li&gt;
  &lt;li&gt;呼出元と処理実行タイミングが異なるため、どこで実際の処理が走るのか読みにくくなる&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="ios" /><category term="swift" /><summary type="html">例えばlazyを使うと10万件のフルアクセス処理が1件で済みます。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-08-07-ios-swift-lazy-sequence-and-collection/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-08-07-ios-swift-lazy-sequence-and-collection/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">iOSアプリ開発のエコシステムを考えてみた</title><link href="https://blog.mothule.com/ios/swift/ios-swift-ecosystem-design" rel="alternate" type="text/html" title="iOSアプリ開発のエコシステムを考えてみた" /><published>2020-08-02T00:00:00+09:00</published><updated>2020-08-06T03:45:17+09:00</updated><id>https://blog.mothule.com/ios/swift/ios-swift-ecosystem-design</id><content type="html" xml:base="https://blog.mothule.com/ios/swift/ios-swift-ecosystem-design">&lt;p&gt;iOSアプリ開発で開発の周辺環境いわゆるエコシステムについて、現状どうなってるか整理も踏まえて考えて見ました。&lt;/p&gt;

&lt;h2 id=&quot;この記事では説明しない部分&quot;&gt;この記事では説明しない部分&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;アーキテクチャパターンやログ機能などアプリの骨組みデザイン&lt;/li&gt;
  &lt;li&gt;ニッチ過ぎるサービスやツール&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;エコシステムをなすツールやサービス一覧&quot;&gt;エコシステムをなすツールやサービス一覧&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-08-02-ios-swift-ecosystem-design/ecosystem-design.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-08-02-ios-swift-ecosystem-design/ecosystem-design.png&quot; width=&quot;100%&quot; alt=&quot;ios-ecosystem-design&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;上図は今回構築に使ったツールとその関係を階層構造で表した図です。&lt;/p&gt;

&lt;h3 id=&quot;framework管理&quot;&gt;Framework管理&lt;/h3&gt;

&lt;p&gt;frameworkの作成や管理をするツール群です。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;CocoaPods&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;span&gt;&lt;a href=&quot;/ios/cocoapods/ios-cocoapods-managed-rbenv-bundler&quot;&gt;CocoaPodsをrbenv+bundlerで管理する&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Carthage&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;span&gt;&lt;a href=&quot;/ios/carthage/ios-carthage&quot;&gt;Carthageの使い方を体系的に理解する&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;説明は省きます。詳細は各リンク先を見てください。&lt;/p&gt;

&lt;h3 id=&quot;タスク管理&quot;&gt;タスク管理&lt;/h3&gt;

&lt;p&gt;ビルド、テスト、アーカイブなど開発における処理の作成・管理として&lt;strong&gt;Fastlane&lt;/strong&gt;を使います。&lt;/p&gt;

&lt;p&gt;Fastlaneでタスク管理することで、細かな手続きを一塊にして呼び出しを簡略化します。&lt;br /&gt;
またコマンドラインで呼び出せることでCIに乗せれたりもできます。&lt;br /&gt;
そして、CIサービスの中でFastlaneのタスクを呼ぶことでCIの種類に依存せず処理を管理できます。&lt;/p&gt;

&lt;h3 id=&quot;プロジェクト管理&quot;&gt;プロジェクト管理&lt;/h3&gt;

&lt;p&gt;Xcodeプロジェクトの管理として&lt;strong&gt;XcodeGen&lt;/strong&gt;を使います。&lt;br /&gt;
XcodeGenのメリットや使い方に関しては「&lt;span&gt;&lt;a href=&quot;/ios/xcodegen/ios-xcodegen-basic&quot;&gt;XcodeGenを基本から理解する&lt;/a&gt;&lt;/span&gt;
」で説明してます。&lt;/p&gt;

&lt;h3 id=&quot;静的解析ツール&quot;&gt;静的解析ツール&lt;/h3&gt;
&lt;p&gt;機械的にコード品質チェックを行うツールとして&lt;strong&gt;SwiftLint&lt;/strong&gt;を使います。&lt;/p&gt;

&lt;h3 id=&quot;管理ツール管理&quot;&gt;管理ツール管理&lt;/h3&gt;
&lt;p&gt;FastlaneやCocoaPodsなどを管理ツールのバージョンを管理するツール群です。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;rbenv&lt;/strong&gt;&lt;br /&gt;
Rubyのバージョン管理ツール。&lt;br /&gt;
FastlaneやCocoaPods, bundlerなどRuby製ツールの言語バージョンを制御する。&lt;br /&gt;
これがないとグルーバルのRubyバージョンを使うことになり、もし別都合でバージョンアップして、そのバージョンが下位互換だった場合に動かなくなる。&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;bundler&lt;/strong&gt;&lt;br /&gt;
gemの一元管理gem。&lt;br /&gt;
FastlaneやCocoaPodsなどのRuby製ツールのツールバージョンを制御する。&lt;br /&gt;
これがないとグローバルのFastlaneやCocoaPodsを使うことになり、他プロジェクト都合のバージョンアップに影響受ける。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;パッケージ管理&quot;&gt;パッケージ管理&lt;/h3&gt;
&lt;p&gt;SwiftLintやCarthageなどのバージョンを管理するツール類です。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Homebrew&lt;/strong&gt;&lt;br /&gt;
&lt;span&gt;&lt;a href=&quot;/mac/homebrew/mac-homebrew-basic&quot;&gt;MacのHomebrewとは？仕組み・使い方と用語整理&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Mint&lt;/strong&gt;
Mintを使うことでプロジェクト間のツールバージョンを疎結合にできます。&lt;br /&gt;
&lt;span&gt;&lt;a href=&quot;/ios/mint/ios-mint-basic-usage&quot;&gt;iOS開発環境には重要エコシステムとなるMintの理解と利用&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;mintバージョンで問題が起きる場合&quot;&gt;Mintバージョンで問題が起きる場合&lt;/h4&gt;
&lt;p&gt;今回MintはHomebrewからインストールする構成です。&lt;br /&gt;
もし、プロジェクト毎にMintのバージョンを持つ必要がある場合は、インストールを&lt;a href=&quot;https://github.com/yonaskolb/Mint#install&quot;&gt;自身でインストールする方法&lt;/a&gt;にすることで、Mintのバージョンを制御することが可能になります。&lt;/p&gt;

&lt;p&gt;またSwiftバージョンにズレが起きてる場合は,&lt;a href=&quot;https://github.com/kylef/swiftenv&quot;&gt;SwiftEnv&lt;/a&gt;を使って&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.swift-version&lt;/code&gt;ファイルでSwiftバージョンを固定することもできます。&lt;/p&gt;

&lt;h3 id=&quot;テスト環境&quot;&gt;テスト環境&lt;/h3&gt;
&lt;p&gt;テストプロジェクトで使うテストフレームワーク・ツール群です。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Quick&lt;/strong&gt;
BDDフレームワークです。通常のXCTestを使うよりテストケース管理がしやすくなります。&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Nimble&lt;/strong&gt;
Matcherです。XCTAssertを直接使うよりコードが読みやすく書きやすくなります。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ciサービス&quot;&gt;CIサービス&lt;/h3&gt;
&lt;p&gt;モバイルに特化した&lt;strong&gt;Bitrise&lt;/strong&gt;を使います。&lt;br /&gt;
ここに関してはCircleCIなど他領域(backend, frontend)などの費用関係もあるのである程度ゆらぎはあると思います。&lt;/p&gt;

&lt;h2 id=&quot;組み合わせてみる&quot;&gt;組み合わせてみる&lt;/h2&gt;
&lt;p&gt;実際に組み合わせたiOSプロジェクト雛形を&lt;a href=&quot;https://github.com/mothule/ios_project_template&quot;&gt;GitHub&lt;/a&gt;に用意しました。&lt;br /&gt;
Homebrewなど一部はGitHubにアップしないので反映されないものもあります。&lt;/p&gt;

&lt;h3 id=&quot;ビルド構成が複雑なら設定を外部ファイル化する&quot;&gt;ビルド構成が複雑なら設定を外部ファイル化する&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;project.yml&lt;/code&gt;の中身が複雑になるのは主にSettings周りなので、そうなってきた場合は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settingGroups&lt;/code&gt;と&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;configFiles&lt;/code&gt;を使って&lt;br /&gt;
外部ファイルに抽出する必要が出てくると思います。&lt;br /&gt;
ここらへんは&lt;span&gt;&lt;a href=&quot;/ios/xcodegen/ios-xcodegen-settings&quot;&gt;XcodeGenのSettings周りを整理する&lt;/a&gt;&lt;/span&gt;
にやり方を書いてあります。&lt;/p&gt;

&lt;h3 id=&quot;レイヤードアーキテクチャデザインによってembedded-frameworkを増やす&quot;&gt;レイヤードアーキテクチャデザインによってEmbedded frameworkを増やす&lt;/h3&gt;
&lt;p&gt;レイヤードアーキテクチャはサンプルなので2層に留めてます。&lt;br /&gt;
実際のアプリ開発時ではアーキテクチャデザインに合わせます。&lt;/p&gt;

&lt;h2 id=&quot;マーケティング領域&quot;&gt;マーケティング領域&lt;/h2&gt;

&lt;p&gt;アプリ開発のエコシステムの遠い位置にはマーケティング領域が出てくると思います。&lt;br /&gt;
これらはビジネスサイドの領域ではありますが、データ集計フローは開発サイドの役割になります。&lt;br /&gt;
ただ、今回は本筋から離れてしまうので説明しません。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Firebase Analytics&lt;/li&gt;
  &lt;li&gt;BigQuery&lt;/li&gt;
  &lt;li&gt;Redash&lt;/li&gt;
  &lt;li&gt;Slack&lt;/li&gt;
  &lt;li&gt;Google Data Studio&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="ios" /><category term="swift" /><category term="program-design" /><category term="cocoapods" /><category term="carthage" /><category term="xcodegen" /><category term="mint" /><category term="quick" /><category term="nimble" /><category term="rbenv" /><category term="bundler" /><category term="homebrew" /><category term="swiftlint" /><category term="bitrise" /><category term="fastlane" /><summary type="html">iOSアプリ開発で開発の周辺環境いわゆるエコシステムについて、現状どうなってるか整理も踏まえて考えて見ました。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-08-02-ios-swift-ecosystem-design/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-08-02-ios-swift-ecosystem-design/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">iOS開発環境には重要エコシステムとなるMintの理解と利用</title><link href="https://blog.mothule.com/ios/mint/ios-mint-basic-usage" rel="alternate" type="text/html" title="iOS開発環境には重要エコシステムとなるMintの理解と利用" /><published>2020-07-31T00:00:00+09:00</published><updated>2020-07-31T17:41:29+09:00</updated><id>https://blog.mothule.com/ios/mint/ios-mint-basic-usage</id><content type="html" xml:base="https://blog.mothule.com/ios/mint/ios-mint-basic-usage">&lt;p&gt;HomebrewでSwiftLintのバージョンを上げたら、別プロジェクトにも影響与えてコントロール失う経験ありますよね。Mintはそれを解決します。&lt;/p&gt;

&lt;h2 id=&quot;mintとは&quot;&gt;Mintとは？&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/yonaskolb/Mint&quot;&gt;Mint&lt;/a&gt;は、&lt;strong&gt;Swift製コマンドラインツールのパッケージマネージャーです。&lt;/strong&gt;
ツールのインストールと実行ができます。&lt;/p&gt;

&lt;p&gt;同じパッケージマネージャーにHomebrewがあり、そちらのほうが遥かにメジャーです。&lt;br /&gt;
Swift製ツールもHomebrewからインストールできますし、&lt;br /&gt;
パッケージマネージャーとして使いやすく安定しています。&lt;/p&gt;

&lt;p&gt;では「何故Mintがいいのか？Homebrewじゃ駄目なのか？」について説明します。&lt;/p&gt;

&lt;h2 id=&quot;ios開発におけるhomebrewが抱える課題&quot;&gt;iOS開発におけるHomebrewが抱える課題&lt;/h2&gt;
&lt;p&gt;通常はMac1台に複数のiOSアプリやSwiftアプリを開発するはずです。&lt;br /&gt;
各プロジェクトでは開発環境に差異あれど、同じツールを使うことは当然ありえます。&lt;br /&gt;
同様にそれぞれ使ってるバージョンが異なることも起きます。&lt;/p&gt;

&lt;p&gt;しかし、&lt;strong&gt;Homebrewは異なるバージョンのツールをバージョン別管理ができません。&lt;/strong&gt;&lt;br /&gt;
そのためツールをバージョンアップすると、各プロジェクトに影響を与え動作しなくなるリスクがあります。&lt;/p&gt;

&lt;h2 id=&quot;mintが解決する課題&quot;&gt;Mintが解決する課題&lt;/h2&gt;
&lt;p&gt;Mintは、バージョン別管理を可能とし、管轄外のバージョン変更課題を解決します。&lt;/p&gt;

&lt;p&gt;Mintでは、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Mintfile&lt;/code&gt;によりプロジェクト毎にバージョンを管理できます。&lt;br /&gt;
これにより&lt;strong&gt;PC内の複数プロジェクト間のSwiftツールの疎結合を実現します。&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;mintのパッケージ管理方法について&quot;&gt;Mintのパッケージ管理方法について&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;バージョン別でパッケージを管理します&lt;/li&gt;
  &lt;li&gt;バージョン指定でパッケージを実行できます&lt;/li&gt;
  &lt;li&gt;パッケージはシンボリックリンクでパスを通してどこからでも実行できます&lt;/li&gt;
  &lt;li&gt;パッケージとバージョンの一覧をMintfileというプレーンテキストで管理できます。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;mintのインストール方法&quot;&gt;Mintのインストール方法&lt;/h2&gt;

&lt;p&gt;Homebrewでインストールできます。&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;brew &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mint
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;他にも&lt;a href=&quot;https://github.com/yonaskolb/Mint#make&quot;&gt;Make&lt;/a&gt;, &lt;a href=&quot;https://github.com/yonaskolb/Mint#using-mint-itself&quot;&gt;Mintコード&lt;/a&gt;, &lt;a href=&quot;https://github.com/yonaskolb/Mint#swift-package-manager&quot;&gt;Swift Package Manager&lt;/a&gt;からもインストールできます。&lt;/p&gt;

&lt;h2 id=&quot;mintでパッケージをインストールする方法&quot;&gt;Mintでパッケージをインストールする方法&lt;/h2&gt;

&lt;p&gt;Mintでパッケージをインストールするには&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint install&lt;/code&gt;コマンドを使います。&lt;br /&gt;
例えば&lt;a href=&quot;https://github.com/yonaskolb/XcodeGen&quot;&gt;XcodeGen&lt;/a&gt;の最新版をインストールするなら下記になります。&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;yonaskolb/XcodeGen
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;バージョン指定でインストール&quot;&gt;バージョン指定でインストール&lt;/h3&gt;
&lt;p&gt;バージョンを指定してインストールするならパッケージ情報の末尾に&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@x.x.x&lt;/code&gt;形式でバージョン情報を渡します。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;yonaskolb/XcodeGen@1.2.4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;パスを通さずインストール&quot;&gt;パスを通さずインストール&lt;/h3&gt;
&lt;p&gt;デフォルトではインストールすると&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/bin&lt;/code&gt;にシンボリックリンクを作成します。&lt;br /&gt;
これによりどこからでもアクセスできるようになります。&lt;br /&gt;
もしインストールするパッケージをリンクしたくない場合は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--no-link&lt;/code&gt;をつけます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;yonaskolb/XcodeGen@1.2.4 &lt;span class=&quot;nt&quot;&gt;--no-link&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;再インストール&quot;&gt;再インストール&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--force&lt;/code&gt;オプションをつけることで再インストールできます。&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;yonaskolb/XcodeGen@1.2.4 &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;mintでパッケージを実行する方法&quot;&gt;Mintでパッケージを実行する方法&lt;/h2&gt;
&lt;p&gt;Mintでインストールしたパッケージを実行するには、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint run&lt;/code&gt;コマンドを使います。&lt;br /&gt;
例えば最新版の&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;XcodeGen&lt;/code&gt;で&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;generate&lt;/code&gt;を実行したい場合は下記になります。&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint run XcodeGen generate
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ちなみに小文字でも動きます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint run xcodegen generate
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;バージョン指定で実行&quot;&gt;バージョン指定で実行&lt;/h3&gt;
&lt;p&gt;Mintにインストールしてるパッケージが複数バージョンある中で、&lt;br /&gt;
リンクしてない古いバージョンを実行する場合は、&lt;br /&gt;
バージョン情報をつけることで指定実行できます。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint run xcodegen@1.2.4 generate
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;mintfileでパッケージ管理する方法&quot;&gt;Mintfileでパッケージ管理する方法&lt;/h2&gt;
&lt;p&gt;Mintでは指定のパッケージとバージョンを列挙して一度にインストールしたりアップデートできます。&lt;br /&gt;
例えばiOSアプリ開発のGit管理下にMintfileを置くことで、そのレポジトリで使うツールやバージョンを制御することができます。&lt;/p&gt;

&lt;p&gt;このMintfileを利用することでプロジェクト間のバージョン差異における干渉を解決します。&lt;/p&gt;

&lt;h3 id=&quot;mintfileの書き方&quot;&gt;Mintfileの書き方&lt;/h3&gt;
&lt;p&gt;至って簡単です。コマンドラインでインストールや実行するときに指定してる方法と同じです。&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Mintfile&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;yonaskolb/XcodeGen@2.16.0
realm/SwiftLint@0.39.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;mintfile内のパッケージを使う&quot;&gt;Mintfile内のパッケージを使う&lt;/h2&gt;
&lt;p&gt;そのまま&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint run xcodegen&lt;/code&gt;と実行すれば、インストールされてなければインストールして実行してくれます。
まとめて指定バージョンを予め全部インストールしておきたい場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint bootstrap&lt;/code&gt;コマンドを実行します。
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint bootstrap&lt;/code&gt;ではデフォルトはリンク処理を行いません。&lt;br /&gt;
もしリンク処理したい場合は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint bootstrap --link&lt;/code&gt;で実行してください。&lt;/p&gt;

&lt;h3 id=&quot;注意-mintfileの有効範囲について&quot;&gt;注意: Mintfileの有効範囲について&lt;/h3&gt;
&lt;p&gt;rbenvや.gitignoreなどと異なり、カレントディレクトリ上にMintfileが見つからない場合はバージョン解決はMintfileで行いません。
例えば次のツリー構造のとき、Bディレクトリで&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint run xcodege&lt;/code&gt;を実行すると&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Mintfile&lt;/code&gt;内のバージョンではなくMintがインストールしてる最新で実行します。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Aディレクトリ
    &lt;ul&gt;
      &lt;li&gt;Mintfile&lt;/li&gt;
      &lt;li&gt;Bディレクトリ&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Mintfileのないディレクトリ上でmintコマンドを実行する場合は注意してください。&lt;/p&gt;

&lt;h2 id=&quot;その他オプション&quot;&gt;その他オプション&lt;/h2&gt;

&lt;h3 id=&quot;mintからの出力を止める&quot;&gt;mintからの出力を止める&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--silent&lt;/code&gt;オプションを使います。&lt;/p&gt;

&lt;p&gt;&lt;em&gt;–silentなし&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint run xcodegen version
🌱 Finding latest version of XcodeGen
🌱 Running xcodegen 2.16.0...
Version: 2.16.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;–silentあり&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mint run &lt;span class=&quot;nt&quot;&gt;--silent&lt;/span&gt; xcodegen version
Version: 2.16.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;mintのキャッシュパスとリンク先を変える&quot;&gt;mintのキャッシュパスとリンク先を変える&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MINT_PATH&lt;/code&gt;を変更することでインストールしたパッケージの保存場所を変更できます。&lt;br /&gt;
デフォルトは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/user/local/lib/mint&lt;/code&gt;です。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;MINT_LINK_PATH&lt;/code&gt;を変更するとシンボリックリンクの作成場所を変更できます。&lt;br /&gt;
デフォルトは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/bin&lt;/code&gt;です。&lt;/p&gt;

&lt;h2 id=&quot;実際にxcodeプロジェクトに組み込む&quot;&gt;実際にXcodeプロジェクトに組み込む&lt;/h2&gt;

&lt;p&gt;SwiftLintを実際に組み込んでみます。&lt;br /&gt;
小さいですが一応&lt;a href=&quot;https://github.com/mothule/research_mint&quot;&gt;GitHub&lt;/a&gt;にも上げてあります。&lt;br /&gt;
git cloneして&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint bootstrap&lt;/code&gt;を試してみるのもいいかもしれないです。&lt;/p&gt;

&lt;p&gt;HomebrewではBuild Scriptでは&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;which swiftlint &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;swiftlint
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;warning: SwiftLint not installed, download from https://github.com/realm/SwiftLint&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ですが、&lt;/p&gt;

&lt;p&gt;Mint経由でインストールした場合は、&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; ./Mintfile &lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;mint run swiftlint
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;warning: SwiftLint not installed, download from https://github.com/realm/SwiftLint&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;と、実行条件とシェルコマンドを変える必要があります。&lt;/p&gt;

&lt;h3 id=&quot;実行条件はmintfileを見たほうがいい&quot;&gt;実行条件はMintfileを見たほうがいい&lt;/h3&gt;
&lt;p&gt;ネットで見かけた記事では↓のようにmintコマンドの有無でシェルコマンドを実行していましたが、&lt;br /&gt;
MintはMintfileがなくても、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mint run swiftlint&lt;/code&gt;と実行すれば勝手に最新版を取ってきて実行するので、&lt;br /&gt;
mintコマンドの有無ではなく、Mintfileの有無のほうが「知らぬ間に最新版で実行してた」を防げると思います。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;which mint &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/null&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;mint run swiftlint
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;warning: SwiftLint not installed, download from https://github.com/realm/SwiftLint&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><category term="ios" /><category term="mint" /><category term="swift" /><summary type="html">HomebrewでSwiftLintのバージョンを上げたら、別プロジェクトにも影響与えてコントロール失う経験ありますよね。Mintはそれを解決します。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-07-31-ios-mint-basic-usage/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-07-31-ios-mint-basic-usage/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Xcodeのxcconfigの理解と使い方</title><link href="https://blog.mothule.com/ios/xcode/ios-xcode-xcconfig-how-to-use" rel="alternate" type="text/html" title="Xcodeのxcconfigの理解と使い方" /><published>2020-07-30T00:00:00+09:00</published><updated>2020-07-30T19:41:30+09:00</updated><id>https://blog.mothule.com/ios/xcode/ios-xcode-xcconfig-how-to-use</id><content type="html" xml:base="https://blog.mothule.com/ios/xcode/ios-xcode-xcconfig-how-to-use">&lt;h2 id=&quot;xcconfigとは&quot;&gt;xcconfigとは？&lt;/h2&gt;
&lt;p&gt;Xcodeのビルド構成ファイルです。略称からして&lt;strong&gt;XC&lt;/strong&gt;ode&lt;strong&gt;CONFIG&lt;/strong&gt;urationといったところだと思います。&lt;/p&gt;

&lt;p&gt;Xcodeではビルドパラメータ等を「プロジェクト」や「ターゲット」単位で設定ができます。&lt;br /&gt;
これらは通常XcodeのBuild Settingsから閲覧・編集することができますが、以下の不便があります。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;やり直し(アンドゥ)が効かない&lt;/li&gt;
  &lt;li&gt;クリック操作が多く編集効率が悪い&lt;/li&gt;
  &lt;li&gt;カスタマイズしたプロパティが把握しにくい&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;xcconfigはこれら&lt;strong&gt;設定情報をテキスト形式の外部ファイルとして扱えるようにしたファイル&lt;/strong&gt;です。&lt;br /&gt;
xcconfigを使うことでプロジェクトやターゲットのビルドパラメータを定義・上書きできます。&lt;/p&gt;

&lt;h3 id=&quot;xcconfigの利点&quot;&gt;xcconfigの利点&lt;/h3&gt;

&lt;p&gt;xcconfigによる利点は元の編集状況が抱える課題を解決する利点を持ちます。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;テキストとして扱える&lt;/li&gt;
  &lt;li&gt;カスタマイズした設定だけが並ぶ&lt;/li&gt;
  &lt;li&gt;Gitとの相性が良い(コンフリクト解消難易度が低い)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;xcconfigの書き方&quot;&gt;xcconfigの書き方&lt;/h2&gt;

&lt;p&gt;下記の項目について説明します。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ファイル作成&lt;/li&gt;
  &lt;li&gt;ビルドパラメータの設定&lt;/li&gt;
  &lt;li&gt;パラメータの型&lt;/li&gt;
  &lt;li&gt;変数展開&lt;/li&gt;
  &lt;li&gt;ビルドパラメータにプラットフォーム条件の追加&lt;/li&gt;
  &lt;li&gt;他ビルド構成ファイルの読み込み&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;構成設定ファイルのフォーマット説明はAppleの&lt;a href=&quot;https://help.apple.com/xcode/mac/11.4/#/dev745c5c974&quot;&gt;Configuration Settings File (xcconfig) format&lt;/a&gt;を参考してます。&lt;/p&gt;

&lt;h3 id=&quot;ファイル作成&quot;&gt;ファイル作成&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/1.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/1.png&quot; width=&quot;50%&quot; alt=&quot;xcconfig&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;テキスト形式の外部ファイルなので拡張子さえあっていれば追加方法は何でもいいです。&lt;br /&gt;
もしXcode上から追加する場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Configuration Settings File&lt;/code&gt;を選んでください。↓&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/2.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/2.png&quot; width=&quot;75%&quot; alt=&quot;NewFileOnXcode&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ビルドパラメータの設定&quot;&gt;ビルドパラメータの設定&lt;/h3&gt;

&lt;p&gt;設定フォーマットは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ParameterName = ParameterValue&lt;/code&gt;となります。&lt;br /&gt;
1ビルドパラメータ1行で表現します。&lt;br /&gt;
例えば下記はアプリアイコンで使うAppIcon名を設定する例です。&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// アプリアイコンとして使うAppIconの名前&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;ASSETCATALOG_COMPILER_APPICON_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;AppIcon&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;また利点にも記載しましたが、全てのビルドパラメータを記載する必要はありません。&lt;br /&gt;
カスタマイズしたパラメータだけを列挙します。&lt;br /&gt;
未記載のビルドパラメータはXcode側が持つデフォルト値が使われます。&lt;/p&gt;

&lt;h4 id=&quot;上書き&quot;&gt;上書き&lt;/h4&gt;
&lt;p&gt;ビルドパラメータは上書きが可能です。
後から書いた同一パラメータが使われます。&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;ASSETCATALOG_COMPILER_APPICON_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;AppIcon&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;ASSETCATALOG_COMPILER_APPICON_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;AppIcon2&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ← これが使われる&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;この上書きルールは同一ファイルだけでなくファイルを横断して適用されます。&lt;br /&gt;
つまりプロジェクトで&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon&lt;/code&gt;と設定しても&lt;br /&gt;
ターゲットで&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon2&lt;/code&gt;と設定してれば、&lt;br /&gt;
そのターゲットでは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AppIcon2&lt;/code&gt;になります。&lt;/p&gt;

&lt;h3 id=&quot;パラメータの型&quot;&gt;パラメータの型&lt;/h3&gt;

&lt;p&gt;パラメータの値には多様な型をサポートしています。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;型&lt;/th&gt;
      &lt;th&gt;説明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Boolean&lt;/td&gt;
      &lt;td&gt;YES or NO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;string&lt;/td&gt;
      &lt;td&gt;テキスト&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;enumeration(string)&lt;/td&gt;
      &lt;td&gt;定義済みテキスト&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;string list&lt;/td&gt;
      &lt;td&gt;空白区切りのテキスト一覧。もしテキスト内に空白があるなら引用符(“)で囲みます。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;path&lt;/td&gt;
      &lt;td&gt;ファイルまたはディレクトリのパス(形式はPOSIXに準拠)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;path list&lt;/td&gt;
      &lt;td&gt;string listのpath版&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;変数展開&quot;&gt;変数展開&lt;/h3&gt;

&lt;p&gt;パラメータ値では変数展開ができます。形式は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$(variable_name)&lt;/code&gt;になります。
例えば下記は、既存パラメータを上書きせず追加する例です。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;OTHER_SWIFT_FLAGS = $(inherited) -v
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;下記のように他のビルドパラメータも参照可能です。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;OBJROOT = $(SYMROOT)

DSTROOT = /tmp/$(PROJECT_NAME).dst

CONFIGURATION_BUILD_DIR = $(BUILD_DIR)/$(CONFIGURATION)$(EFFECTIVE_PLATFORM_NAME)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ビルドパラメータにプラットフォーム条件の追加&quot;&gt;ビルドパラメータにプラットフォーム条件の追加&lt;/h3&gt;

&lt;p&gt;ビルドパラメータには簡易ですが、条件をつけれます。&lt;br /&gt;
条件はSDKとArchitectureの2種類です。&lt;/p&gt;

&lt;p&gt;SDKとはmacOSやiOSなどで、Architectureはx86_64やarm64などです。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;条件名&lt;/th&gt;
      &lt;th&gt;値(例)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;sdk&lt;/td&gt;
      &lt;td&gt;macos10.12, iphoneos10.2, iphoneos*&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;arch&lt;/td&gt;
      &lt;td&gt;x86_64, arm64&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;設定フォーマットは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ParameterName[Conditional=ConditionalValue] = ParameterValue&lt;/code&gt;になります。&lt;/p&gt;

&lt;p&gt;例えば下記はiOSの場合のみ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OTHER_SWIFT_FLAGS&lt;/code&gt;に&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt;を追加する例です。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;OTHER_SWIFT_FLAGS[sdk=iphoneos*] = $(inherited) -v
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;組み合わせ可能&quot;&gt;組み合わせ可能&lt;/h4&gt;
&lt;p&gt;条件sdkとarchは組み合わせ可能です。&lt;/p&gt;

&lt;p&gt;下記はx86_64系iOSの場合のみ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OTHER_SWIFT_FLAGS&lt;/code&gt;に&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt;を追加する例です。&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;OTHER_SWIFT_FLAGS[sdk=iphoneos*][arch=x86_64] = $(inherited) -v
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;他ビルド構成ファイルの読み込み&quot;&gt;他ビルド構成ファイルの読み込み&lt;/h3&gt;
&lt;p&gt;xcconfigは他のxcconfigを読み込み展開できます。
他xcconfigを読み込むには&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#include &quot;other file path&quot;&lt;/code&gt;を使います。&lt;br /&gt;
パスは「ファイル名」「相対パス」「絶対パス」を利用できます。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ファイル名: 同一ディレクトリ上から一致するファイルを探します。&lt;/li&gt;
  &lt;li&gt;相対パス: 同一ディレクトリ上を基点として一致するファイルを探します。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;他xcconfigへのパス解決は、ビルド設定を処理する前に実施されます。&lt;/p&gt;

&lt;h4 id=&quot;指定ファイル見つからない場合&quot;&gt;指定ファイル見つからない場合&lt;/h4&gt;
&lt;p&gt;ビルド時に指定のファイルが見つからない場合は、ビルド警告が表示されます。&lt;br /&gt;
もしこの警告を抑制したい場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#include? &quot;other file path&quot;&lt;/code&gt;と、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;?&lt;/code&gt;をつけます。&lt;/p&gt;

&lt;h3 id=&quot;ビルドパラメータ名が分からない場合&quot;&gt;ビルドパラメータ名が分からない場合&lt;/h3&gt;

&lt;p&gt;もしビルドパラメータ名が分からない場合は「&lt;span&gt;&lt;a href=&quot;/ios/xcode/ios-xcode-xcconfig-how-to-search-build-config&quot;&gt;xcconfigで使うパラメータ名の見つけ方&lt;/a&gt;&lt;/span&gt;
」に探し方をまとめてあります。&lt;/p&gt;

&lt;h2 id=&quot;xcconfigの実践活用&quot;&gt;xcconfigの実践活用&lt;/h2&gt;

&lt;p&gt;実際のアプリ開発ではどういった運用にすればよいか考えてみます。&lt;/p&gt;

&lt;p&gt;ターゲットの数ですが、最近の動向から考えて次の観点で考えてみます。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;4層構造&lt;/li&gt;
  &lt;li&gt;AppExtension N個&lt;/li&gt;
  &lt;li&gt;各ターゲットにUT&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;これを元にプロジェクトとターゲットの構図で表すと次のツリー構造です。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Project
    &lt;ul&gt;
      &lt;li&gt;App&lt;/li&gt;
      &lt;li&gt;AppTests&lt;/li&gt;
      &lt;li&gt;AppUITests&lt;/li&gt;
      &lt;li&gt;AppCore&lt;/li&gt;
      &lt;li&gt;AppCoreTests&lt;/li&gt;
      &lt;li&gt;Infrastructure&lt;/li&gt;
      &lt;li&gt;InfrastructureTests&lt;/li&gt;
      &lt;li&gt;Library&lt;/li&gt;
      &lt;li&gt;LibraryTests&lt;/li&gt;
      &lt;li&gt;AppExtensionA&lt;/li&gt;
      &lt;li&gt;AppExtensionB&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;11個のターゲットに分かれました。
分類としては、&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;レイヤー別&lt;/li&gt;
  &lt;li&gt;テスト or プロダクト&lt;/li&gt;
  &lt;li&gt;AppExtension&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;の3カテゴリに分けられるかと思います。&lt;/p&gt;

&lt;p&gt;これを11個それぞれにビルドパラメータを設定するのは多量の重複が発生するので、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;include&lt;/code&gt;を利用したxcconfigの階層化が必要かと思います。
階層の分け方としては先程分けた分類に加えてBuild Configurationを考慮した形が良さそうです。&lt;/p&gt;

&lt;p&gt;つまり整理すると、&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;プロジェクトのビルド構成を用意&lt;/li&gt;
  &lt;li&gt;テスト共通ビルド構成を用意&lt;/li&gt;
  &lt;li&gt;プロダクト共通ビルド構成を用意&lt;/li&gt;
  &lt;li&gt;ターゲット毎にビルド構成を用意&lt;/li&gt;
  &lt;li&gt;Build Configuration共通ビルド構成を用意&lt;/li&gt;
  &lt;li&gt;Build Configuration毎にビルド構成を用意&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;になります。&lt;/p&gt;

&lt;p&gt;Xcode上で見るとこうなります。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/3.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/3.png&quot; width=&quot;50%&quot; alt=&quot;LayeredTargets&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;これを今回はxcconfigを次のように分けました。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/4.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/4.png&quot; width=&quot;100%&quot; alt=&quot;xcconfigMapping&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;xcconfigファイル自体はターゲットフォルダと1:1ではないので、別フォルダとして集約しました。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/5.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/5.png&quot; width=&quot;50%&quot; alt=&quot;xcconfigFiles&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;これら親子関係をツリー表現すると次のようになります。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Project.base.xcconfig
    &lt;ul&gt;
      &lt;li&gt;Project.debug.xcconfig
        &lt;ul&gt;
          &lt;li&gt;App.base.xcconfig
            &lt;ul&gt;
              &lt;li&gt;App.debug.xcconfig&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;UnitTest.xcconfig&lt;/li&gt;
          &lt;li&gt;UITest.xcconfig&lt;/li&gt;
          &lt;li&gt;Extension.base.xcconfig&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;releaseはdebugと同じなので省略してあります。&lt;/p&gt;

&lt;h3 id=&quot;今回この構成にした理由&quot;&gt;今回この構成にした理由&lt;/h3&gt;

&lt;p&gt;テスト系xcconfigはReleaseで実施するケースは考えにくいためBuild Configurationによる分割はしていません。&lt;br /&gt;
AppExtension系xconfigは今の所この2つのターゲットではDebugでもReleaseでも差異はなかったのですが、開発を進めるにあたって分岐しやすいと予想し、
そのときの半分準備としてbaseを使うようにしています。今後DebugとReleaseで分岐が生まれたら、他同様になります。&lt;/p&gt;

&lt;p&gt;当然ですが、この構成が絶対正解ではありません。プロダクトの特性や状況に応じその時点でのベストは異なります。&lt;br /&gt;
エンジニアはこれを考えるのが重要な仕事です。&lt;/p&gt;

&lt;h3 id=&quot;xcconfigの中身&quot;&gt;xcconfigの中身&lt;/h3&gt;

&lt;p&gt;中身は予定通り&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#include&lt;/code&gt;プレフィックスを使って共通xcconfigを読み込んでから、それぞれ特別値を個別設定してあります。&lt;/p&gt;

&lt;p&gt;例えば下記は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Project.debug.xcconfig&lt;/code&gt;の全容です。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#include &quot;Project.base.xcconfig&quot;

//:configuration = Debug
ONLY_ACTIVE_ARCH = YES
DEBUG_INFORMATION_FORMAT = dwarf
ENABLE_TESTABILITY = YES
GCC_DYNAMIC_NO_PIC = NO
GCC_OPTIMIZATION_LEVEL = 0
GCC_PREPROCESSOR_DEFINITIONS = DEBUG=1 $(inherited)
SWIFT_OPTIMIZATION_LEVEL = -Onone
SWIFT_ACTIVE_COMPILATION_CONDITIONS = DEBUG
MTL_ENABLE_DEBUG_INFO = INCLUDE_SOURCE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;xcconfigは少なく抑えたほうが良い&quot;&gt;xcconfigは少なく抑えたほうが良い&lt;/h3&gt;

&lt;p&gt;なるべくxcconfigのファイル数は少なくなるような構成にしてたほうがいいです。&lt;br /&gt;
なぜならxcconfigの分岐ポイントが「Build Configuration」「Platform」「Testing」と分岐要素が多いことでファイル数が増えやすいためです。&lt;br /&gt;
例えば、今回はBuild Configurationはデフォルト値となるDebugとReleaseの2つでした。&lt;br /&gt;
しかしこれがDebug,Staging,AppStore,CIと4つに増えた場合にその分増えてしまいます。&lt;/p&gt;

&lt;p&gt;もしBuild Configurationも増えるようであれば、組み合わせ爆発を起こさないためにも工夫が必要です。&lt;/p&gt;</content><author><name></name></author><category term="ios" /><category term="xcode" /><category term="xcconfig" /><summary type="html">xcconfigとは？ Xcodeのビルド構成ファイルです。略称からしてXCodeCONFIGurationといったところだと思います。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-use/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">xcconfigで使うパラメータ名の見つけ方</title><link href="https://blog.mothule.com/ios/xcode/ios-xcode-xcconfig-how-to-search-build-config" rel="alternate" type="text/html" title="xcconfigで使うパラメータ名の見つけ方" /><published>2020-07-30T00:00:00+09:00</published><updated>2020-07-30T19:49:43+09:00</updated><id>https://blog.mothule.com/ios/xcode/ios-xcode-xcconfig-how-to-search-build-config</id><content type="html" xml:base="https://blog.mothule.com/ios/xcode/ios-xcode-xcconfig-how-to-search-build-config">&lt;p&gt;xcconfigは便利ですが、中身のパラメータ名が何書けばいいか特定できないと使い物になりません。&lt;br /&gt;
この記事はXcodeのBuild Settingsで書いてるビルドパラメータがxcconfigではどう書くのかを説明します。&lt;/p&gt;

&lt;p&gt;xcconfigについて分からない方は「&lt;span&gt;&lt;a href=&quot;/ios/xcode/ios-xcode-xcconfig-how-to-use&quot;&gt;Xcodeのxcconfigの理解と使い方&lt;/a&gt;&lt;/span&gt;
」に詳細を説明してます。&lt;/p&gt;

&lt;h2 id=&quot;xcconfigへの変換はxcodeがサポートしてる&quot;&gt;xcconfigへの変換はXcodeがサポートしてる&lt;/h2&gt;
&lt;p&gt;xcconfigの書き方が分かって実際に使おうにも、ビルドパラメータ名が分からないと設定しようがありません。&lt;br /&gt;
XcodeのBuild Settingsでカスタマイズされた項目をxcconfigだとどうやって書けばいいか分からないと思います。&lt;br /&gt;
実は&lt;strong&gt;XcodeのBuild Settingsからxcconfigへのフォーマット変換はXcodeがサポートしてます。&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;確認する方法は2つあります。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;XcodeのBuild Settingsの表示方法をパラメータ名に変更する&lt;/li&gt;
  &lt;li&gt;XcodeのBuild Settingsの各パラメータをxcconfig形式でコピーする&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;xcodeのbuild-settingsの表示方法をパラメータ名に変更&quot;&gt;XcodeのBuild Settingsの表示方法をパラメータ名に変更&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Build Settings&lt;/code&gt;を開いた後に&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Editor &amp;gt; Show Setting Names&lt;/code&gt;を選ぶと、表示されてるパラメータ名が表示用からコマンド用に変わります。&lt;/p&gt;

&lt;video playsinline=&quot;&quot; muted=&quot;&quot; autoplay=&quot;&quot; loop=&quot;&quot; width=&quot;100%&quot; height=&quot;400px&quot;&gt;
    &lt;source type=&quot;video/mp4&quot; src=&quot;/assets/videos/2020-07-30-ios-xcode-xcconfig-how-to-search-build-config/0.mp4&quot; /&gt;
&lt;/video&gt;

&lt;p&gt;例えば、 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Architectures &amp;gt; Build Active Architecture Only&lt;/code&gt;であれば、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ONLY_ACTIVE_ARCH&lt;/code&gt;になります。&lt;br /&gt;
これをxcconfigで使うなら&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ONLY_ACTIVE_ARCH = YES&lt;/code&gt;となります。&lt;/p&gt;

&lt;h2 id=&quot;xcodeのbuild-settingsの各パラメータをxcconfig形式でコピー&quot;&gt;XcodeのBuild Settingsの各パラメータをxcconfig形式でコピー&lt;/h2&gt;

&lt;p&gt;パラメータ名を確認するだけなら&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Show Setting Names&lt;/code&gt;で確認できますが、Xcodeはそれよりも強力な変換機能を備えています。&lt;br /&gt;
実は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Build Settings&lt;/code&gt;はコピー＆ペーストをサポートしており、対象ビルドパラメータをコピーしてテキストにペーストすると、xcconfig形式で貼り付けします。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-search-build-config/1.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-search-build-config/1.png&quot; width=&quot;100%&quot; alt=&quot;XcodeBuildSettings&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;例えば&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Build Active Architecture Only&lt;/code&gt;の項目を選択し、コピー(⌘+C)してテキストエディタでペースト(⌘+V)すると、下記のように貼り付けされます。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//:configuration = Debug
ONLY_ACTIVE_ARCH = YES

//:configuration = Release

//:completeSettings = some
ONLY_ACTIVE_ARCH
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;//:configuration = Debug&lt;/code&gt;や&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Release&lt;/code&gt;とはBuild Configuration毎に分けられてます。
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Release&lt;/code&gt;に何も表示されていないのは、カスタマイズ値ではなくデフォルト値なので空になります。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;some&lt;/code&gt;はコピーしたビルドパラメータの明確ビルドパラメータ名が列挙されます。ここはxcconfigでは不要なので削除します。&lt;/p&gt;

&lt;p&gt;もう一つ例として&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Build Options &amp;gt; Debug Information Format&lt;/code&gt;を見るとこうなります。&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//:configuration = Debug
DEBUG_INFORMATION_FORMAT = dwarf

//:configuration = Release
DEBUG_INFORMATION_FORMAT = dwarf-with-dsym

//:completeSettings = some
DEBUG_INFORMATION_FORMAT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これを使えばXcodeからxcconfigを作りたい場合に&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Build Settings&lt;/code&gt;の項目全部を選択してコピーすれば、簡単に現在のビルド構成を表現したxcconfigが作成できます。&lt;/p&gt;</content><author><name></name></author><category term="ios" /><category term="xcode" /><category term="xcconfig" /><summary type="html">xcconfigは便利ですが、中身のパラメータ名が何書けばいいか特定できないと使い物になりません。 この記事はXcodeのBuild Settingsで書いてるビルドパラメータがxcconfigではどう書くのかを説明します。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-search-build-config/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-07-30-ios-xcode-xcconfig-how-to-search-build-config/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">たまに必要なGitの操作tips</title><link href="https://blog.mothule.com/tools/git/tools-git-tips" rel="alternate" type="text/html" title="たまに必要なGitの操作tips" /><published>2020-07-29T00:00:00+09:00</published><updated>2020-07-29T23:34:17+09:00</updated><id>https://blog.mothule.com/tools/git/tools-git-tips</id><content type="html" xml:base="https://blog.mothule.com/tools/git/tools-git-tips">&lt;p&gt;普段使いでは使うことはない操作だけどたまに必要になる操作集を集めてます。
順次増やしていきます。&lt;/p&gt;

&lt;h2 id=&quot;リモートのみファイル削除&quot;&gt;リモートのみファイル削除&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cached&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ファイル名]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;フォルダ削除&quot;&gt;フォルダ削除&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cached&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ディレクトリ名]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;最新のみcloneシャロークローン&quot;&gt;最新のみclone(シャロークローン)&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone &lt;span class=&quot;nt&quot;&gt;--depth&lt;/span&gt; 1 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Git URL]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;指定ワードを含むコミットを検索&quot;&gt;指定ワードを含むコミットを検索&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;検索ワード] &lt;span class=&quot;nt&quot;&gt;--patch&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--patch&lt;/code&gt;をつけない場合はログ一覧が並びます。&lt;/p&gt;

&lt;h2 id=&quot;コミットした人で検索&quot;&gt;コミットした人で検索&lt;/h2&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git log &lt;span class=&quot;nt&quot;&gt;--author&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;コミットした人の名前]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><category term="tools" /><category term="git" /><summary type="html">普段使いでは使うことはない操作だけどたまに必要になる操作集を集めてます。 順次増やしていきます。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-07-29-tools-git-tips/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-07-29-tools-git-tips/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">XcodeGenのSettings周りを整理する</title><link href="https://blog.mothule.com/ios/xcodegen/ios-xcodegen-settings" rel="alternate" type="text/html" title="XcodeGenのSettings周りを整理する" /><published>2020-07-29T00:00:00+09:00</published><updated>2020-07-31T00:45:04+09:00</updated><id>https://blog.mothule.com/ios/xcodegen/ios-xcodegen-settings</id><content type="html" xml:base="https://blog.mothule.com/ios/xcodegen/ios-xcodegen-settings">&lt;p&gt;XcodeGenは便利ですが、プロジェクト仕様ファイル(project.yml)のSettingsに関して自分の中で不透明なので整理しました。&lt;/p&gt;

&lt;h2 id=&quot;settingsとは&quot;&gt;Settingsとは？&lt;/h2&gt;
&lt;p&gt;XcodeGenのプロジェクト仕様ファイル内で使えるビルド設定を定義するプロパティと総称。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settings&lt;/code&gt;はプロジェクトとターゲットの2箇所で使える&lt;/li&gt;
  &lt;li&gt;ビルド設定の値の解決はレベル順となっている&lt;/li&gt;
  &lt;li&gt;Build Configuration(DebugやReleaseなど)別でビルドパラメータを設定できる&lt;/li&gt;
  &lt;li&gt;Build Configurationにも適用される&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base&lt;/code&gt;プロパティがある&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settingGroups&lt;/code&gt;でビルド設定を共通化できる&lt;/li&gt;
  &lt;li&gt;Xcode同様に自動で適用されるプリセットビルド設定がある&lt;/li&gt;
  &lt;li&gt;ビルド設定群を別ファイル(xcconfig)として抜き出せる&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ビルド設定はプロジェクトとターゲットで出来る&quot;&gt;ビルド設定はプロジェクトとターゲットで出来る&lt;/h2&gt;

&lt;p&gt;例えば次のプロジェクト仕様はプロジェクトとMyAppターゲットそれぞれでビルド設定をセットしています。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;project_value&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;MyApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;target_value&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ビルド設定の値の解決方法&quot;&gt;ビルド設定の値の解決方法&lt;/h2&gt;
&lt;p&gt;ビルド設定の値はレベル順に見ていってる。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Target&lt;/li&gt;
  &lt;li&gt;Target xcconfig file&lt;/li&gt;
  &lt;li&gt;Project&lt;/li&gt;
  &lt;li&gt;Project xcconfig file&lt;/li&gt;
  &lt;li&gt;SDK defaults&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Targetの設定が一番強く、下に行くほど範囲は広いが上書きされる。&lt;/p&gt;

&lt;p&gt;検証するために次のプロジェクト仕様で確認する。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Settings&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;bundleIdPrefix&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;com.mothule&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;project_value&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;


&lt;span class=&quot;na&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;application&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;platform&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;iOS&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;sources&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Settings&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;target_value&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これを実際にXcodeで確認するとこうなる。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/2020-07-29-ios-xcodegen-settings/1.png&quot;&gt;&lt;img src=&quot;/assets/images/2020-07-29-ios-xcodegen-settings/1.png&quot; width=&quot;100%&quot; alt=&quot;XcodeBuildSettings&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;想定通り、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Settings&lt;/code&gt;ターゲットでは値は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;target_value&lt;/code&gt;で解決されてる。&lt;br /&gt;
この挙動に関しては理解は容易と言える。&lt;/p&gt;

&lt;h2 id=&quot;build-configuration別でビルドパラメータを設定できる&quot;&gt;Build Configuration別でビルドパラメータを設定できる&lt;/h2&gt;

&lt;p&gt;DebugやReleaseなどBuild Configuration別でビルド設定を変えることができます。&lt;br /&gt;
例えば下記はDebug時は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DEBUG&lt;/code&gt;が定義され、Release時は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RELEASE&lt;/code&gt;が定義されます。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;MyApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;configs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;Debug&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RELEASE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;build-configurationにも適用されるbaseプロパティがある&quot;&gt;Build Configurationにも適用される&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base&lt;/code&gt;プロパティがある&lt;/h2&gt;
&lt;p&gt;Build Configurationに依存せず設定したビルドパラメータを入れたい場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;base&lt;/code&gt;を使います。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;configs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Debug&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;debug&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;CI&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;debug&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;release&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;DEVELOPMENT_TEAM&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;HogeHoge&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;configs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Debug&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;CI&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;CI&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SWIFT_ACTIVE_COMPILATION_CONDITIONS&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;RELEASE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;この場合はどのBuild Configurationであっても&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DEVELOPMENT_TEAM&lt;/code&gt;は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HogeHoge&lt;/code&gt;となります。&lt;/p&gt;

&lt;h2 id=&quot;settinggroupsでビルド設定を共通化できる&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settingGroups&lt;/code&gt;でビルド設定を共通化できる&lt;/h2&gt;

&lt;p&gt;例えばターゲットが5個あって、そのうち3つには同じビルド設定群がある場合、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settingGroups&lt;/code&gt;を使うことで設定箇所を1箇所にまとめることができます。&lt;/p&gt;

&lt;p&gt;下記は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settingGroups&lt;/code&gt;を使わなかったケースです。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;App1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEVELOPMENT_TEAM&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;HogeHoge&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;App2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEVELOPMENT_TEAM&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;HogeHoge&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;App3&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEVELOPMENT_TEAM&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;HogeHoge&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;DebugApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEBUG_MODE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;YES&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;StgApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEBUG_MODE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;NO&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;これだと1箇所ずつ更新する必要があり、更新し忘れなどが発生します。&lt;br /&gt;
下記のように&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;settingGroups&lt;/code&gt;を使うことで情報を1箇所に集約することができます。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;settingGroups&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ← 任意のグループ名&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEVELOPMENT_TEAM&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;HogeHoge&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;App1&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;App2&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;App3&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;DebugApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEBUG_MODE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;YES&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;StgApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;DEBUG_MODE&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;NO&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;xcode同様に自動で適用されるプリセットビルド設定がある&quot;&gt;Xcode同様に自動で適用されるプリセットビルド設定がある&lt;/h2&gt;
&lt;p&gt;Xcodeがプロジェクトやターゲット追加時に自動で設定が設定されるのと同様に、XcodeGenにもプロジェクトとターゲットにデフォルト設定を設定する。&lt;br /&gt;
プロジェクトにはDebugとReleaseの設定が、ターゲットにはプラットフォームとプロダクトタイプに応じた設定が適用される。&lt;/p&gt;

&lt;p&gt;これらのプリセットを変更・無効するには&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;options.settingPresets&lt;/code&gt;プロパティを使います。&lt;br /&gt;
デフォルトでは&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;all&lt;/code&gt;となっておりプロジェクトとターゲット両方に対して適用されています。&lt;br /&gt;
もしターゲットだけ、プロジェクトだけとしたい場合は、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;options.settingPresets: project&lt;/code&gt;や&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;targets&lt;/code&gt;とすることで部分適用されます。&lt;br /&gt;
もし両方とも自動適用を無効にする場合は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;none&lt;/code&gt;になります。&lt;/p&gt;

&lt;h2 id=&quot;ビルド設定群を別ファイルxcconfigとして抜き出せる&quot;&gt;ビルド設定群を別ファイル(xcconfig)として抜き出せる&lt;/h2&gt;
&lt;p&gt;ビルド設定のボリュームが大きくなると、プロジェクト仕様全体として見通しの悪いファイルとなってしまいます。&lt;br /&gt;
その場合は&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;configFiles&lt;/code&gt;を使って&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xcconfig&lt;/code&gt;ファイルをインポートしてビルド構成を別ファイルに抽出できます。&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;configFiles&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Debug&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;debug.xcconfig&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;release.xcconfig&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;MyApp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;configFiles&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;Debug&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;MyApp/debug.xcconfig&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;Release&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;MyApp/release.xcconfig&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;configFiles&lt;/code&gt;でもプロジェクト単位とターゲット単位で設定できます。&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xcconfig&lt;/code&gt;について分からない方は「&lt;span&gt;&lt;a href=&quot;/ios/xcode/ios-xcode-xcconfig-how-to-use&quot;&gt;Xcodeのxcconfigの理解と使い方&lt;/a&gt;&lt;/span&gt;
」にまとめた記事をお読みください。&lt;/p&gt;

&lt;h2 id=&quot;結論&quot;&gt;結論&lt;/h2&gt;
&lt;p&gt;この記事を書くにあたって、xcconfigの仕様を調べましたが、settings周りの仕様はxcconfigの仕様を把握すると理解が一気に深まりました。&lt;br /&gt;
xcconfigについては「&lt;span&gt;&lt;a href=&quot;/ios/xcode/ios-xcode-xcconfig-how-to-use&quot;&gt;Xcodeのxcconfigの理解と使い方&lt;/a&gt;&lt;/span&gt;
」にまとめてあります。&lt;/p&gt;</content><author><name></name></author><category term="ios" /><category term="xcodegen" /><category term="xcode" /><category term="xcconfig" /><summary type="html">XcodeGenは便利ですが、プロジェクト仕様ファイル(project.yml)のSettingsに関して自分の中で不透明なので整理しました。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.mothule.com/assets/images/2020-07-29-ios-xcodegen-settings/0.png" /><media:content medium="image" url="https://blog.mothule.com/assets/images/2020-07-29-ios-xcodegen-settings/0.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>